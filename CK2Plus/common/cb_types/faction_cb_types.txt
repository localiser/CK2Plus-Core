## normal scopes(including posttitle scopes) ##
# ROOT = actor
# FROM = recipient
# <no scope change> = thirdparty character
## title scopes ##
# ROOT = actor
# FROM = recipient
# <no scope change> = thirdparty landed title	
#
# the following effects/triggers exists (example execution order: on_success->on_success_title->on_success_posttitle):
# is_valid, is_valid_title, on_add, on_add_title, on_add_posttitle, on_success, on_success_title, on_success_posttitle, on_fail, on_fail_title, on_fail_posttitle, on_reverse_demand, on_reverse_demand_title, on_reverse_demand_posttitle
#
# Added on_attacker_leader_death, on_defender_leader_death and on_thirdparty_death, which all trigger when corresponding character dies
# These three all have war scopes, which currently has the following scope changes: 
# attacker, defender, thirdparty(only valid if thirdparty character is involved), thirdparty_title(only valid if thirdparty title is involved)
#

#Can be launched by feudal, republican and religious factions
lower_crown_authority_law = {
	name = CB_NAME_LOWER_CROWN_AUTHORITY_LAW
	war_name = WAR_NAME_LOWER_CROWN_AUTHORITY_LAW
	sprite = 6
	truce_days = 3650
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	#attacker_alliance_occ_warscore = yes # Occupying any holding of any attacker counts towards war score
	
	can_use = {
		ROOT = {
			vassal_of = FROM
		}
	}	
	
	can_use_title = {
		holder_scope = { independent = yes }
		OR = {
			tier = king
			tier = emperor
		}
	}

	on_success = {
		ROOT = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
					prestige = -100
				}
			}
		}	
		ROOT = {
			opinion = {
				modifier = opinion_lowered_crown_authority
				who = FROM
				months = 12
			}
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		FROM = { prestige = -500 }
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}				
				}				
			}	
		}
		FROM = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
		ROOT = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
	}

	on_success_title = {
		if = {
			limit = { has_law = centralization_1 }
			add_law_w_cooldown = centralization_0
		}
		if = {
			limit = { has_law = centralization_2 }
			add_law_w_cooldown = centralization_1
		}
		if = {
			limit = { has_law = centralization_3 }
			add_law_w_cooldown = centralization_2
		}
		if = {
			limit = { has_law = centralization_4 }
			add_law_w_cooldown = centralization_3
		}
	}

	on_fail = {
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
				}
			}			
		}	
		ROOT = {
			prestige = -100
		}
		
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
		
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war				
				}				
			}	
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
				reverse_opinion = {
					who = FROM
					modifier = opinion_civil_war_loser
					months = 60
				}
			}		
		}	
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				limit = { liege = { character = FROM } }
				prisoner = FROM
			}
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}					
				}				
			}	
		}
		hidden_tooltip = {
			FROM = { character_event = { id = 1000182419 } }
		}
		FROM = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
		ROOT = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

change_seniority_succession_law = {
	name = CB_NAME_SENIORITY_SUCCESSION_LAW
	war_name = WAR_NAME_SENIORITY_SUCCESSION_LAW
	sprite = 6
	truce_days = 3650
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	#attacker_alliance_occ_warscore = yes # Occupying any holding of any attacker counts towards war score
	
	can_use = {
		ROOT = {
			vassal_of = FROM	
		}
	}

	is_valid_title = {
		NOT = {
			has_law = succ_seniority
		}
		OR = {
			tier = emperor
			tier = king
			is_primary_holder_title = yes
		}
	}
	
	on_success = {
		ROOT = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		FROM = {
			any_demesne_title = { # All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
#					is_titular = no
					NOT = { has_law = centralization_0 }
				}
				if = {
					limit = { has_law = centralization_1 }
					add_law = centralization_0
				}
				if = {
					limit = { has_law = centralization_2 }
					add_law = centralization_1
				}
				if = {
					limit = { has_law = centralization_3 }
					add_law = centralization_2
				}
				if = {
					limit = { has_law = centralization_4 }
					add_law = centralization_3
				}
			}
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = {
				participation_scaled_prestige = 100 
			}
		}
		FROM = { prestige = -500 }
	}

	on_success_title = {
		succession_w_cooldown = seniority
	}

	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				limit = { liege = { character = FROM } }
				prisoner = FROM
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}


change_primogeniture_succession_law = {
	name = CB_NAME_PRIMOGENITURE_SUCCESSION_LAW
	war_name = WAR_NAME_PRIOGENITURE_SUCCESSION_LAW
	sprite = 6
	truce_days = 3650
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	#attacker_alliance_occ_warscore = yes # Occupying any holding of any attacker counts towards war score
	
	can_use = {
		ROOT = {
			vassal_of = FROM	
		}
	}
		
	is_valid_title = {
		NOT = {
			has_law = succ_primogeniture
		}
		OR = {
			tier = emperor
			tier = king
			is_primary_holder_title = yes
		}
	}

	
	on_success = {
		ROOT = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		FROM = {
			
			any_demesne_title = { # All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
#					is_titular = no
					NOT = { has_law = centralization_0 }
				}
				if = {
					limit = { has_law = centralization_1 }
					add_law = centralization_0
				}
				if = {
					limit = { has_law = centralization_2 }
					add_law = centralization_1
				}
				if = {
					limit = { has_law = centralization_3 }
					add_law = centralization_2
				}
				if = {
					limit = { has_law = centralization_4 }
					add_law = centralization_3
				}
			}
		}
		
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = {
				participation_scaled_prestige = 100 
			}
		}
		FROM = { prestige = -500 }
	}

	on_success_title = {
		succession_w_cooldown = primogeniture
	}

	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				limit = { liege = { character = FROM } }
				prisoner = FROM
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

change_gavelkind_succession_law = {
	name = CB_NAME_GAVELKIND_SUCCESSION_LAW
	war_name = WAR_NAME_GAVELKIND_SUCCESSION_LAW
	sprite = 6
	truce_days = 3650
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	#attacker_alliance_occ_warscore = yes # Occupying any holding of any attacker counts towards war score
	
	can_use = {
		ROOT = {
			vassal_of = FROM	
		}
	}

	is_valid_title = {
		NOT = {
			has_law = succ_gavelkind
		}
		OR = {
			tier = emperor
			tier = king
			is_primary_holder_title = yes
		}
	}
	
	on_success = {
		ROOT = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		FROM = {
			any_demesne_title = { # All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
#					is_titular = no
					NOT = { has_law = centralization_0 }
				}
				if = {
					limit = { has_law = centralization_1 }
					add_law = centralization_0
				}
				if = {
					limit = { has_law = centralization_2 }
					add_law = centralization_1
				}
				if = {
					limit = { has_law = centralization_3 }
					add_law = centralization_2
				}
				if = {
					limit = { has_law = centralization_4 }
					add_law = centralization_3
				}
			}
		}
		
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = {
				participation_scaled_prestige = 100 
			}
		}
		FROM = { prestige = -500 }
	}

	on_success_title = {
		succession_w_cooldown = gavelkind
	}

	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				limit = { liege = { character = FROM } }
				prisoner = FROM
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

change_feudal_elective_succession_law = {
	name = CB_NAME_FEUDAL_ELECTIVE_SUCCESSION_LAW
	war_name = WAR_NAME_FEUDAL_ELECTIVE_SUCCESSION_LAW
	sprite = 6
	truce_days = 3650
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	#attacker_alliance_occ_warscore = yes # Occupying any holding of any attacker counts towards war score
	
	can_use = {
		ROOT = {
			vassal_of = FROM	
		}
	}

	is_valid_title = {
		NOT = {
			has_law = succ_feudal_elective
		}
		OR = {
			tier = emperor
			tier = king
			is_primary_holder_title = yes
		}

#		OR = {
#			AND = {
#				tier = emperor
#				OR = {
#					ROOT = { tier = king }
#					ROOT = { tier = duke }
#				}
#			}
#			AND = {
#				tier = king
#				ROOT = { tier = duke }
#			}
#			AND = {
#				tier = duke
#				ROOT = { tier = count }
#			}
#		}

	}
	
	on_success = {
		ROOT = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		FROM = {		
			any_demesne_title = { # All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
#					is_titular = no
					NOT = { has_law = centralization_0 }
				}
				if = {
					limit = { has_law = centralization_1 }
					add_law = centralization_0
				}
				if = {
					limit = { has_law = centralization_2 }
					add_law = centralization_1
				}
				if = {
					limit = { has_law = centralization_3 }
					add_law = centralization_2
				}
				if = {
					limit = { has_law = centralization_4 }
					add_law = centralization_3
				}
			}
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = {
				participation_scaled_prestige = 100 
			}
		}
		FROM = { prestige = -500 }
	}
	
	on_success_title = {
		succession_w_cooldown = feudal_elective
	}

	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
	}
	
	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				limit = { liege = { character = FROM } }
				prisoner = FROM
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

cb_faction_independence = {
	name = CB_NAME_INDEPENDENCE
	war_name = WAR_NAME_FACTION_INDEPENDENCE
	sprite = 12
	truce_days = 3650
	major_revolt = yes
	
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	
	#attacker_alliance_occ_warscore = yes # Occupying any holding of any attacker counts towards war score
	
	can_use = {
		ROOT = {
			vassal_of = FROM
		}
	}

	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = { 
					FROM = { 
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		FROM = {
			any_demesne_title = {
				NOT = { lower_tier_than = ROOT }
				temporary = no
			}
		}
	}

	on_success = {
		ROOT = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
				}
			}
		}	
		if = {
			limit = {
				FROM = { independent = yes }
			}
			hidden_tooltip = { 
				any_attacker = {
					character_event = { id = 1000182684 days = 3 }
					set_character_flag = considered_for_independence
				} 
				FROM = { 
					any_vassal = { 
						limit = { NOT = { has_character_flag = considered_for_independence } }
						character_event = { id = 1000182684 days = 3 }
					}
				} 
				any_attacker = {
					clr_character_flag = considered_for_independence
				}
			}
		}
		if = {
			limit = {
				FROM = {
					independent = yes
				}
			}
			any_attacker = {
				set_defacto_liege = THIS
				hidden_tooltip = {
					FROM = {
						reverse_opinion = {
							who = PREV
							modifier = opinion_independent
							years = 100
						}					
						opinion = {
							who = PREV
							modifier = opinion_independent
							years = 100
						}
					}
					prestige = 100
				}
			}
			hidden_tooltip = { k_papal_state = { holder_scope = { character_event = { id = 1000182870 } } } }
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = { prestige = -500 }

		FROM = {	
			any_demesne_title = { # All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
					NOT = { has_law = centralization_0 }
				}
				if = {
					limit = { has_law = centralization_1 }
					add_law = centralization_0
				}
				if = {
					limit = { has_law = centralization_2 }
					add_law = centralization_1
				}
				if = {
					limit = { has_law = centralization_3 }
					add_law = centralization_2
				}
				if = {
					limit = { has_law = centralization_4 }
					add_law = centralization_3
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				any_vassal = {
					set_variable = { which = "separatist_sentiment" value = 0 }
				}		
			}
		}
		FROM = { clr_character_flag = faction_separatist_war }
		hidden_tooltip = { k_papal_state = { holder_scope = { character_event = { id = 1000182870 } } }	}
	}

	on_fail = {
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
				}
			}
		}		
		ROOT = {
			prestige = -50
			prisoner = FROM
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = -50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = {
				participation_scaled_prestige = -50 
			}
		}
		hidden_tooltip = {
			FROM = {
				any_vassal = {
					set_variable = { which = "separatist_sentiment" value = 0 }
				}		
			}
		}
		FROM = { clr_character_flag = faction_separatist_war }
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
				}
			}
		}		
		hidden_tooltip = {
			any_attacker = {
				reverse_opinion = {
					who = FROM
					modifier = opinion_civil_war_loser
					months = 60
				}		
			}
		}
	
		ROOT = {
			prestige = -100
			prisoner = FROM
		}
		
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = -100
		}
		
		any_attacker = {
			limit = { 
				NOT = { character = ROOT }
				liege = { character = FROM } 
			}
			prisoner = FROM
			participation_scaled_prestige = -100
		}
		
		FROM = {
			prestige = 50
		}
		hidden_tooltip = {
			FROM = {
				any_vassal = {
					set_variable = { which = "separatist_sentiment" value = 0 }
				}		
			}
		}
		FROM = { clr_character_flag = faction_separatist_war }
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 150
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

claim_on_liege_plot = {
	name = CB_NAME_CLAIM
	war_name = WAR_NAME_PRETENDER
	sprite = 3
	truce_days = 3650
	hostile_against_others = yes

	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	#attacker_alliance_occ_warscore = yes # Occupying any holding of any attacker counts towards war score
	
	can_use_title = {
		FROM = {
			has_landed_title = PREV
		}
	}

	is_valid_title = {
		FROM = {
			has_landed_title = PREV
		}
	}

	on_success = {
		if = {
			limit = {
				FROM = { independent = yes }
			}
			hidden_tooltip = { 
				any_attacker = {
					character_event = { id = 1000182684 days = 3 }
					set_character_flag = considered_for_independence
				} 
				FROM = { 
					any_vassal = { 
						limit = { NOT = { has_character_flag = considered_for_independence } }
						character_event = { id = 1000182684 days = 3 }
					}
				} 
				any_attacker = {
					clr_character_flag = considered_for_independence
				}
			}
		} 
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
					imprison = ROOT
					reverse_opinion = {
						who = ROOT
						modifier = opinion_civil_war_loser
						months = 60
					}
				}
			}			
		}			
		ROOT = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		FROM = { imprison = ROOT }
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}	
		FROM = { prestige = -500 }
		hidden_tooltip = { k_papal_state = { holder_scope = { character_event = { id = 1000182870 } } }	}
	}
	
	on_success_title = {
		if = {
			limit = {
				is_primary_holder_title = yes
			}
			FROM = {
				any_demesne_title = {
					limit =	{
						is_primary_holder_title_tier = yes
						OR = {
							tier = king
							tier = emperor
						}
					}
					if = {
						limit = { has_law = centralization_1 }
						add_law_w_cooldown = centralization_0
					}
					if = {
						limit = { has_law = centralization_2 }
						add_law_w_cooldown = centralization_1
					}
					if = {
						limit = { has_law = centralization_3 }
						add_law_w_cooldown = centralization_2
					}
					if = {
						limit = { has_law = centralization_4 }
						add_law_w_cooldown = centralization_3
					}									
				}
				any_demesne_title = {
					limit = {
						is_primary_holder_title_tier = yes
						is_primary_holder_title = no
					}
					usurp_title_plus_barony_if_unlanded = ROOT
				}
				primary_title = {
					usurp_title_plus_barony_if_unlanded = ROOT
					hidden_tooltip = { make_primary_title = yes }
				}
				set_defacto_liege = ROOT		
			}
			hidden_tooltip = {
				if = {
					limit = {
						FROM = {
							ROOT = { 
								primary_title = { 
									NOT = { has_law = succ_feudal_elective } 
									FROM = {
										capital_scope = {
											de_jure_liege_or_above = PREVPREV
										}
									}
								} 
							}
							OR = {
								num_of_count_titles = 2
								primary_title = { higher_tier_than = count }
							}
						}
					}
					FROM = {
						capital_scope = {
							county = {
								usurp_title_plus_barony_if_unlanded = ROOT
							}
						}
					}			
				}	
			}
			hidden_tooltip = {
				FROM = { 
					set_defacto_liege = ROOT 
					any_vassal = {
						limit = {
							NOT = { primary_title = { de_jure_liege_or_above = PREVPREV } }
						}
						set_defacto_liege = ROOT 
					}
				}
			}			
		}
		if = {
			limit = {
				is_primary_holder_title = no
				holder = FROM
				OR = {
					tier = king
					tier = emperor
				}
			}
			if = {
				limit = { has_law = centralization_1 }
				add_law_w_cooldown = centralization_0
			}
			if = {
				limit = { has_law = centralization_2 }
				add_law_w_cooldown = centralization_1
			}
			if = {
				limit = { has_law = centralization_3 }
				add_law_w_cooldown = centralization_2
			}
			if = {
				limit = { has_law = centralization_4 }
				add_law_w_cooldown = centralization_3
			}
		}
		if = {
			limit = {
				is_primary_holder_title = no
				holder = FROM
			}
			usurp_title_plus_barony_if_unlanded = ROOT					
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
							has_character_flag = faction_pretender_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war
					clr_character_flag = faction_pretender_war
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}					
				}				
			}	
		}
		hidden_tooltip = {		
			ROOT = {
				set_variable = { which = "faction_mood_feudal" value = 0 }
				set_variable = { which = "faction_mood_court" value = 0 }
				set_variable = { which = "faction_mood_religious" value = 0 }
				set_variable = { which = "faction_mood_republican" value = 0 }
			}
			ROOT = { character_event = { id = 1000182419 } }
		}
		FROM = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
		ROOT = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
	}

	on_fail = {
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
				}
			}
		}	
		ROOT = {
			prestige = -100
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
							has_character_flag = faction_pretender_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war	
					clr_character_flag = faction_pretender_war	
				}				
			}	
		}		
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
			}		
		}		
		ROOT = {
			prestige = -200
		}
		any_attacker = {
			imprison = FROM
			hidden_tooltip = {
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
				reverse_opinion = {
					who = FROM
					modifier = opinion_civil_war_loser
					months = 60
				}	
			}			
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
							has_character_flag = faction_pretender_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war
					clr_character_flag = faction_pretender_war
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}				
				}				
			}	
		}
		hidden_tooltip = {
			FROM = { character_event = { id = 1000182419 } } 
		}
		FROM = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
		ROOT = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
	}
	
	on_reverse_demand_title = {
		ROOT = {	
			any_claim = {
				limit = { holder_scope = { character = FROM } }
				remove_claim = ROOT
			}
		}
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

other_claim_on_liege_plot = {
	name = CB_NAME_CLAIM
	war_name = WAR_NAME_OTHER_PRETENDER
	sprite = 3
	truce_days = 3650
	hostile_against_others = yes

	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	#attacker_alliance_occ_warscore = yes # Occupying any holding of any attacker counts towards war score
	
	can_use_title = {
		FROM = {
			has_landed_title = PREV
		}
	}

	is_valid_title = {
		FROM = {
			has_landed_title = PREV
		}
	}

	on_success = {
		if = {
			limit = {
				FROM = { independent = yes }
			}
			hidden_tooltip = { 
				any_attacker = {
					character_event = { id = 1000182684 days = 3 }
					set_character_flag = considered_for_independence
				} 
				FROM = { 
					any_vassal = { 
						limit = { NOT = { has_character_flag = considered_for_independence } }
						character_event = { id = 1000182684 days = 3 }
					}
				} 
				any_attacker = {
					clr_character_flag = considered_for_independence
				}
			}
		}
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
					imprison = ROOT
					reverse_opinion = {
						who = ROOT
						modifier = opinion_civil_war_loser
						months = 60
					}					
				}
			}			
		}	
		FROMFROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			opinion = {
				modifier = pressed_my_claim 
				who = PREV
			}
		}
		FROM = { imprison = ROOT }
		any_attacker = {
			limit = { character = FROMFROM }
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = FROMFROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		FROM = { prestige = -500 }
		hidden_tooltip = { k_papal_state = { holder_scope = { character_event = { id = 1000182870 } } }	}
	}
	
	on_success_title = {
		if = {
			limit = {
				is_primary_holder_title = yes
			}
			FROM = {
				any_demesne_title = {
					limit =	{
						is_primary_holder_title_tier = yes
						OR = {
							tier = king
							tier = emperor
						}
					}
					if = {
						limit = { has_law = centralization_1 }
						add_law_w_cooldown = centralization_0
					}
					if = {
						limit = { has_law = centralization_2 }
						add_law_w_cooldown = centralization_1
					}
					if = {
						limit = { has_law = centralization_3 }
						add_law_w_cooldown = centralization_2
					}
					if = {
						limit = { has_law = centralization_4 }
						add_law_w_cooldown = centralization_3
					}									
				}
				any_demesne_title = {
					limit = {
						is_primary_holder_title_tier = yes
						is_primary_holder_title = no
					}
					usurp_title_plus_barony_if_unlanded = ROOT
				}
				primary_title = {
					usurp_title_plus_barony_if_unlanded = ROOT
					hidden_tooltip = { make_primary_title = yes }
				}
				set_defacto_liege = ROOT		
			}
			hidden_tooltip = {
				if = {
					limit = {
						FROM = {
							ROOT = { 
								primary_title = { 
									NOT = { has_law = succ_feudal_elective } 
									FROM = {
										capital_scope = {
											de_jure_liege_or_above = PREVPREV
										}
									}
								} 
							}
							OR = {
								num_of_count_titles = 2
								primary_title = { higher_tier_than = count }
							}
						}
					}
					FROM = {
						capital_scope = {
							county = {
								usurp_title_plus_barony_if_unlanded = ROOT
							}
						}
					}			
				}	
			}
			hidden_tooltip = {
				FROM = { 
					set_defacto_liege = ROOT 
					any_vassal = {
						limit = {
							NOT = { primary_title = { de_jure_liege_or_above = PREVPREV } }
						}
						set_defacto_liege = ROOT 
					}
				}
			}			
		}
		if = {
			limit = {
				is_primary_holder_title = no
				holder = FROM
				OR = {
					tier = king
					tier = emperor
				}
			}
			if = {
				limit = { has_law = centralization_1 }
				add_law_w_cooldown = centralization_0
			}
			if = {
				limit = { has_law = centralization_2 }
				add_law_w_cooldown = centralization_1
			}
			if = {
				limit = { has_law = centralization_3 }
				add_law_w_cooldown = centralization_2
			}
			if = {
				limit = { has_law = centralization_4 }
				add_law_w_cooldown = centralization_3
			}
		}
		if = {
			limit = {
				is_primary_holder_title = no
				holder = FROM
			}
			usurp_title_plus_barony_if_unlanded = ROOT					
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
							has_character_flag = faction_pretender_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war
					clr_character_flag = faction_pretender_war
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}					
				}				
			}	
		}
		hidden_tooltip = {		
			ROOT = {
				set_variable = { which = "faction_mood_feudal" value = 0 }
				set_variable = { which = "faction_mood_court" value = 0 }
				set_variable = { which = "faction_mood_religious" value = 0 }
				set_variable = { which = "faction_mood_republican" value = 0 }
			}
			ROOT = { character_event = { id = 1000182419 } }
		}
		FROM = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
		ROOT = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
	}

	on_fail = {
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
				}
			}
		}
		FROMFROM = {
			prestige = -100
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
							has_character_flag = faction_pretender_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war	
					clr_character_flag = faction_pretender_war	
				}				
			}	
		}		
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
			}		
		}		
		FROMFROM = {
			prestige = -200
		}
		if = {	
			limit = {
				ROOT = {
					any_liege = { character = FROM }
				}
			}
			ROOT = {
				imprison = FROM
				hidden_tooltip = {
					remove_trait = rebel
					any_playable_ruler = {
						reverse_remove_opinion = {
							who = PREV
							modifier = revolting_against
						}	
					}
					reverse_opinion = {
						who = FROM
						modifier = opinion_civil_war_loser
						months = 60
					}	
				}
			}
		}
		any_attacker = {
			limit = {
				NOT = { character = ROOT }
			}
			imprison = FROM
			hidden_tooltip = {
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
				reverse_opinion = {
					who = FROM
					modifier = opinion_civil_war_loser
					months = 60
				}	
			}			
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
							has_character_flag = faction_pretender_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war
					clr_character_flag = faction_pretender_war
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}					
				}				
			}	
		}
		hidden_tooltip = {
			FROM = { character_event = { id = 1000182419 } }
		}
		FROM = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
		ROOT = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
	}
	
	on_reverse_demand_title = {
		ROOT = {	
			any_claim = {
				limit = { holder_scope = { character = FROM } }
				remove_claim = ROOT
			}
		}
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

cb_faction_overthrow_ruler = {
	name = CB_NAME_OVERTHROWRULER
	war_name = WAR_NAME_FACTION_DEPOSE
	sprite = 12
	truce_days = 3650
	
	is_revolt_cb = yes
	major_revolt = yes
	can_call_allies = no
	can_ask_to_join_war = no
	
	#attacker_alliance_occ_warscore = yes # Occupying any holding of any attacker counts towards war score

	can_use = {
		ROOT = {
			vassal_of = FROM
		}
	}

	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = { 
					FROM = { 
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		FROM = {
			any_demesne_title = {
				NOT = { lower_tier_than = ROOT }
				temporary = no
			}
		}
	}

	on_success = {
		hidden_tooltip = { 
			any_attacker = { set_character_flag = rebel_attacker } 
			ROOT = { any_vassal = { set_character_flag = rebel_attacker } }
		}	
		ROOT = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		if = {
			limit = {
				FROM = { independent = yes }
			}
			hidden_tooltip = { 
				any_attacker = {
					character_event = { id = 1000182684 days = 3 }
					set_character_flag = considered_for_independence
				} 
				ROOT = { 
					any_vassal = { 
						limit = { NOT = { has_character_flag = considered_for_independence } }
						character_event = { id = 1000182684 days = 3 }
						set_character_flag = considered_for_independence
					}
				}
				FROM = { 
					any_vassal = { 
						limit = { NOT = { has_character_flag = considered_for_independence } }
						character_event = { id = 1000182684 days = 3 }
					}
				} 
				any_attacker = {
					clr_character_flag = considered_for_independence
				}
				ROOT = { 
					any_vassal = { 				
						clr_character_flag = considered_for_independence
					}
				}
			}
		}
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
			}			
		}		
		hidden_tooltip = {
			any_attacker = {
				limit = { 					
					FROM = {					
						is_adult = yes					
						current_heir = { dynasty = PREV is_adult = yes }
					}
					trait = rebel 
				}
				remove_trait = rebel
			}		
		}
		FROM = {
			prestige = -500
			hidden_tooltip = {
				remove_opinion = {
					who = ROOT
					modifier = declared_war
				}
			}				
			hidden_tooltip = {
				any_vassal = {
						limit = { trait = loyalist }
						remove_trait = loyalist
					}					
			}
			any_demesne_title = { # Decentralize all titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
					NOT = { has_law = centralization_0 }
				}
				if = {
					limit = { has_law = centralization_1 }
					add_law = centralization_0
				}
				if = {
					limit = { has_law = centralization_2 }
					add_law = centralization_1
				}
				if = {
					limit = { has_law = centralization_3 }
					add_law = centralization_2
				}
				if = {
					limit = { has_law = centralization_4 }
					add_law = centralization_3
				}
			}
			hidden_tooltip = { character_event = { id = 1000182861 } }
			if = {
				limit = {
				    NOT = {
                        AND = {
                            is_adult = yes                  
                            current_heir = { is_adult = yes dynasty = PREV}                                                     
                        }
                    }      
				}
				any_demesne_title = {
                    limit = {
                        is_primary_holder_title_tier = yes
						is_primary_holder_title = no
                    }                    
					#for each secondary title, find a single usurper                        
					set_global_flag = seeking_usurper
					#either a rebel with a claim gets the title		
					random_playable_ruler = {
						limit = {
							has_character_flag = rebel_attacker
							has_claim = PREV
							has_global_flag = seeking_usurper									
							OR = {
								AND = {
									is_feudal = no
									FROM = { is_feudal = no }
								}
								AND = {
									is_feudal = yes
									FROM = { is_feudal = yes }
								}
							}
						}
						PREV = {								
							usurp_title_plus_barony_if_unlanded = PREV								
						}
						clr_global_flag = seeking_usurper #clear the flag so it will loop to next secondary title
					}						
					# or a rebel with a de-jure claim gets the title
					random_playable_ruler = {
						limit = {
							has_character_flag = rebel_attacker
							de_jure_liege_or_above = PREV
							has_global_flag = seeking_usurper									
							OR = {
								AND = {
									is_feudal = no
									FROM = { is_feudal = no }
								}
								AND = {
									is_feudal = yes
									FROM = { is_feudal = yes }
								}
							}
						}
						PREV = {						
								usurp_title_plus_barony_if_unlanded = PREV																	
						}
						clr_global_flag = seeking_usurper #clear the flag so it will loop to secondary title
					}
					clr_global_flag = seeking_usurper #clear the flag
				}											
				#remaining primary-tier titles and capital go to rebel leader
				any_demesne_title = {
					limit = {
						is_primary_holder_title_tier = yes
						is_primary_holder_title = no
					}
					usurp_title_plus_barony_if_unlanded = ROOT
				}
				primary_title = {
					usurp_title_plus_barony_if_unlanded = ROOT
					hidden_tooltip = { make_primary_title = yes }
				}
				hidden_tooltip = { set_defacto_liege = ROOT	}
			}
			#otherwise abdicate to most-liked heir
			if = {
				limit = { 										
					is_adult = yes					
					current_heir = { dynasty = FROM is_adult = yes }					
				}
				current_heir = { prestige = -500 }
				abdicate_to_most_liked_by = ROOT					
			}
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 250
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 250 }
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}				
				}				
			}	
		}
		FROM = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
		ROOT = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
		hidden_tooltip = { k_papal_state = { holder_scope = { character_event = { id = 1000182870 } } }	}		
		hidden_tooltip = { 
			any_attacker = { clr_character_flag = rebel_attacker } 
			ROOT = { any_vassal = { clr_character_flag = rebel_attacker } }
		}	
	}

	on_fail = {
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
				remove_trait = rebel
				any_playable_ruler = {
					reverse_remove_opinion = {
						who = PREV
						modifier = revolting_against
					}	
				}
			}
			FROM = {
				any_vassal = {
					limit = { trait = loyalist }
					remove_trait = loyalist
				}
			}
		}	
		ROOT = {
			prestige = -100
		}
		hidden_tooltip = {
			FROM = {
				remove_opinion = {
					who = ROOT
					modifier = declared_war
				}
			}
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war
				}
			}
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		hidden_tooltip = {
			any_attacker = {
				set_defacto_liege = FROM
			}		
		}	
		ROOT = {
			prestige = -200
			tooltip = { prisoner = FROM }
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
		hidden_tooltip = {
			any_attacker = {
				imprison = FROM
				hidden_tooltip = {
					remove_trait = rebel
					any_playable_ruler = {
						reverse_remove_opinion = {
							who = PREV
							modifier = revolting_against
						}	
					}
					reverse_opinion = {
						who = FROM
						modifier = opinion_civil_war_loser
						months = 60
					}	
				}			
			}
		}
		hidden_tooltip = {
			if = {
				limit = {
					FROM = {
						OR = {
							has_character_flag = faction_feudal_war
							has_character_flag = faction_republican_war
							has_character_flag = faction_religious_war
							has_character_flag = faction_court_war
						}
					}
				}
				FROM = {
					clr_character_flag = faction_feudal_war
					clr_character_flag = faction_republican_war
					clr_character_flag = faction_religious_war
					clr_character_flag = faction_court_war
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_feudal" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_feudal" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_republican" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_republican" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_religious" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_religious" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = 0 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -1 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -2 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -3 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}
					if = {
						limit = {
							NOT = { check_variable = { which = "total_faction_mood_court" value = -4 } }
						}
						hidden_tooltip = { change_variable = { which = "faction_mood_court" value = 1 } }
					}				
				}				
			}	
		}
		hidden_tooltip = {
			FROM = { character_event = { id = 1000182419 } }
		}
		FROM = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
		ROOT = { hidden_tooltip = { random_courtier = { limit = { ai = yes } character_event = { id = 1000183004 days = 1 } } } }
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 150
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}